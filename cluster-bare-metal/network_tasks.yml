---
- name: setting kernel params
  sysctl: name="{{ item.name }}" value="{{ item.value }}" ignoreerrors=yes state=present
  with_items:
    - { name: 'net.core.somaxconn', value: 32768 }
    - { name: 'net.core.rmem_max', value: 134217728 }
    - { name: 'net.core.wmem_max', value: 134217728 }
    - { name: 'net.ipv4.tcp_rmem', value: '4096 87380 134217728' }
    - { name: 'net.ipv4.tcp_wmem', value: '4096 87380 134217728' }
    - { name: 'net.core.netdev_max_backlog', value: 300000 }
    - { name: 'net.ipv4.tcp_moderate_rcvbuf', value: 1 }
    - { name: 'net.ipv4.tcp_no_metrics_save', value: 1 }
    - { name: 'net.ipv4.tcp_congestion_control', value: 'htcp' }
    - { name: 'net.ipv4.tcp_mtu_probing', value: 1 }
    - { name: 'net.ipv4.tcp_timestamps', value: 0 }
    - { name: 'net.ipv4.tcp_sack', value: 0 }
    - { name: 'net.ipv4.tcp_max_syn_backlog', value: 4096 }
    - { name: 'net.ipv4.tcp_mem', value: '50576   64768   98152' }
    - { name: 'net.ipv4.ip_local_port_range', value: '4000 65000' }
    - { name: 'net.ipv4.netdev_max_backlog', value: 2500 }
    - { name: 'net.ipv4.tcp_tw_reuse', value: 1 }
    - { name: 'net.ipv4.tcp_fin_timeout', value: 5 }
